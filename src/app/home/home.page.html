<!-- INTERFAZ PARA MOVILES CELULARES Y TABLETS (Escritorio y Android TV mas abajo) -->

<ion-content *ngIf="isMobile">

  <ion-menu contentId="main-content">
    <ion-header>
      <ion-toolbar color="dark">
        <ion-title>Configuración y Ayuda</ion-title>
      </ion-toolbar>
    </ion-header>
    <ion-content class="ion-padding" color="light" style="font-size: 16px;">

      <ion-item color="light" lines="none" style="font-size: 20px;">
        Ayuda al proyecto
      </ion-item>
      <!-- <ion-item color="light" lines="none" style="font-size: 20px;">
        
      </ion-item> -->
      <ion-button color="dark" (click)="presentDonationAlert()">¿Cómo puedo ayudar?</ion-button>
      <ion-item color="light" lines="none" style="font-size: 20px;">
        Opciones del Reproductor
      </ion-item>

      <ion-item color="light" lines="none">
        <ion-toggle [checked]="playerOptions.pip" (ionChange)="playerOptionsChange($event, 'pip')">Reproductor
          flotante</ion-toggle>
      </ion-item>

      <ion-item color="light" lines="none">
        <ion-toggle [checked]="playerOptions.bgroundAudio"
          (ionChange)="playerOptionsChange($event, 'bgroundAudio')">Audio en segundo plano</ion-toggle>
      </ion-item>

      <ion-item color="light" lines="none" style="font-size: 20px; --color: rgb(255, 234, 195);">
        Canales "(VLC)"
      </ion-item>

      <ion-item color="light" lines="none">
        - Para los canales "(VLC)" se debe tener instalado el reproductor "VLC for Android" disponible en Google Play.
      </ion-item>
      <br>
      <ion-item color="light" lines="none">
        <a href="https://play.google.com/store/apps/details?id=org.videolan.vlc" style="text-align: center;"><img
            src="https://www.videolan.org/images/get_it_on_play_logo_large.png" border="0" style="width: 80%;"></a>
      </ion-item>

      <ion-item color="light" lines="none" style="font-size: 20px;">
        Como utilizar la App
      </ion-item>

      <ion-item color="light" lines="none">
        - Selecciona un canal de la lista y se mostrará la vista previa.
      </ion-item>
      <br>
      <ion-item color="light" lines="none">
        <ion-img src="assets/instrucciones/instrucciones-vistaprevia.png"></ion-img>
      </ion-item>
      <br>

      <ion-item color="light" lines="none">
        - Para ver el canal en el reproductor con todas sus funciones disponibles, presiona el boton "Ver en el
        Reproductor".
      </ion-item>
      <br>
      <ion-item color="light" lines="none">
        <ion-img src="assets/instrucciones/instrucciones-continuarviendo.png"></ion-img>
      </ion-item>
      <br>
      <ion-item color="light" lines="none">
        - También puedes filtrar los canales por categorías (Regionales, noticias, nacionales, etc.).
      </ion-item>

      <ion-item color="light" lines="none">
        <ion-img src="assets/instrucciones/filtro1.png"></ion-img>
      </ion-item>
      <br>
      <ion-item color="light" lines="none">
        - En algunos canales, puedes ver la programacion presionando el boton <ion-icon name="calendar-outline"
          style="font-size: 35px; color: #fff; vertical-align: bottom;"></ion-icon>.
      </ion-item>
      <br>
      <ion-item color="light" lines="lines">
        <ion-img src="assets/instrucciones/parrilla1.png"></ion-img>
      </ion-item>

      <ion-item color="light" lines="none" class="ion-text-left">
        <ion-title>Estado de los canales</ion-title>
      </ion-item>

      <ion-item color="light" lines="none">
        <ion-icon style="font-size: 21px; margin-right: 10px; color: rgb(25, 212, 0)"
          name="checkmark-outline"></ion-icon>
        Canal disponible.
      </ion-item>

      <ion-item color="light" lines="none">
        <ion-icon style="font-size: 21px; margin-right: 10px; color: #ff0230" name="close-outline"></ion-icon>
        Canal no disponible.
      </ion-item>

      <ion-item color="light" lines="none">
        <ion-title>Funciones</ion-title>
      </ion-item>

      <ion-item color="light" lines="none">
        <ion-icon name="calendar-outline" style="font-size: 21px; color: #fff; margin-right: 10px;"></ion-icon>
        Ver la programacion del canal.
      </ion-item>

      <ion-item color="light" lines="none">
        <ion-icon name="globe-outline" style="font-size: 27px; color: #fff;"></ion-icon>
        Abrir la página web del canal.
      </ion-item>

      <ion-item color="light" lines="none">
        <i class="fa-solid fa-rotate-right" style="margin-right: 10px; font-size: 21px;"></i>
        Actualizar canales (En el caso que algunos canales no se reproduzcan).
      </ion-item>

      <br>

      <ion-text style="font-style: italic; font-size: 15px;" (click)="bounceBaloon()">*En caso de experimentar problemas
        al reproducir algún canal, revisa tu conexion. En caso contrario el problema podria ser causado desde el mismo
        canal.</ion-text>

    </ion-content>
  </ion-menu>

  <div class="ion-page" id="main-content">
    <ion-header>
      <ion-toolbar color="dark">
        <ion-buttons slot="start">
          <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-title class="ion-text-center">
          
          Fly TV<img src="assets/icon/logo-icon.png"
          style="width: 26px; padding-left: 5px;">
        </ion-title>
        <ion-buttons slot="end">

          <ion-button id="logtrigger" (click)="notificationRead = true;">
            <div class="notifications" *ngIf="notificationRead == false" (click)="notificationRead = true;">
            </div>
            <ion-icon name="notifications-outline" style="font-size: 200%;"></ion-icon>
          </ion-button>

        </ion-buttons>
      </ion-toolbar>
      <ion-item color="light" style="font-size: 12px">
        <ion-grid>
          <ion-row>
            <ion-col (click)="openShareAppModal(true)" class="ion-text-center">
              <ion-icon name="share-social-outline" style="font-size: 20px;"></ion-icon><br>
              <ion-text>Comparte la app</ion-text>
            </ion-col>
            <ion-col (click)="updateChannels()" class="ion-text-center">
              <ion-icon name="refresh-outline" style="font-size: 20px;"></ion-icon>
              <br>
              <ion-text>Actualizar canales</ion-text>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-item>

      <ion-list color="light" class="ion-text-capitalize">
        <ion-item color="light">
          <ion-grid style="padding: 0;">
            <ion-row style="padding: 0;">
              <ion-col size="12" style="padding: 0;">
                <ion-select class="ion-text-capitalize" interface="popover" [(ngModel)]="category"
                  (ionChange)="handleChange($event)" class="select-custom" label="selecciona categoria:">
                  <ion-select-option *ngFor="let cat of categories" [value]="cat" class="ion-text-capitalize">{{ cat
                    }}</ion-select-option>
                </ion-select>
              </ion-col>
            </ion-row>
          </ion-grid>
        </ion-item>
      </ion-list>
      <ion-toolbar color="dark">
        <ion-grid>
          <ion-row>
            <ion-col size="6" style="height: 100%; padding-right: 0; padding-top: 0; padding-bottom: 0;">
              <ion-grid style="height: 100%; padding-right: 0; padding-top: 0; padding-bottom: 0;">
                <ion-row style="height: 100%; padding-right: 0; padding-top: 0; padding-bottom: 0;">
                  <ion-col style="height: 100%; padding-right: 0; padding-top: 0; padding-bottom: 0;">
                      <video id="videoPreview" poster="../../assets/transparent.png" autoplay>
                      </video>
                  </ion-col>
                </ion-row>
              </ion-grid>
            </ion-col>
            <ion-col size="6" style="padding-top: 0;">
              <ion-grid style="height: 100%; padding-top: 0;">
                <ion-row style="height: 50%; padding-top: 0;">
                  <ion-col size="10" style="font-size: 15px; font-weight: bold; padding-top: 0;"
                    *ngIf="previewAutorized">

                    <div style="text-overflow: ellipsis;">
                      <img class="channel-logo" style="vertical-align: middle; width: 18px;"
                        [src]="ranChannel.logo"> <ion-label class="preview-channel-title" [ngClass]="[deviceInfo.includes('tablet') ? 'preview-channel-title-tablet' : 'preview-channel-title']" >{{ranChannel.name.length > 20 ? ranChannel.name.slice(0,20)+' ...' :
                          ranChannel.name}}</ion-label>
                    </div>

                  </ion-col>
                  <ion-col size="2" style="padding-top: 0;">
                    <ion-icon *ngIf="previewAutorized" expand="full" (click)="stopPreviewChannel()"
                      name="close-outline" style="font-size: 25px; font-weight: bolder;"></ion-icon>
                  </ion-col>
                </ion-row>
                <ion-row style="height: 50%;">
                  <ion-col>
                    <div class="btn-reproducir-container">
                      <ion-button [ngClass]="[deviceInfo.includes('tablet') ? 'btn-reproducir-tablet' : 'btn-reproducir']" *ngIf="previewAutorized"
                       [attr.id]="ranChannel.id"
                      [routerLink]="['/reproductor']"
                      [queryParams]="{id: ranChannel.id ,current: ranChannel.transmitiendo.current ? ranChannel.transmitiendo.current: '', name: ranChannel.name ? ranChannel.name: '', next: ranChannel.transmitiendo.next ? ranChannel.transmitiendo.next : '', url: ranChannel.url ? ranChannel.url : '', logo: ranChannel.logo ? ranChannel.logo : '',}"
                      (click)="stopPreviewChannel()">Ver en el<br>Reproductor</ion-button>
                    </div>
                  </ion-col>
                </ion-row>
              </ion-grid>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-toolbar>

    </ion-header>

    <ion-content>

      <ion-list *ngFor="let channel of channels">
        <ion-item color="dark" *ngIf="channel.enabled && channel.url.includes('https')">
          <ion-icon [ngStyle]="{'color': channel.estado ? 'rgb(25, 212, 0)' : '#ff0230'}"
            [attr.name]="channel.estado ? 'checkmark-outline' : 'close-outline'"
            style="font-size: 21px; margin-right: 10px;"></ion-icon>

          <img class="channel-logo" [src]="channel.logo">

          <ion-label *ngIf="channel.iframe" [attr.id]="channel.id" [routerLink]="['/iframe']"
            [queryParams]="{id: channel.id, current: channel.transmitiendo.current ? channel.transmitiendo.current : '', next: channel.transmitiendo.next ? channel.transmitiendo.next : ''}"
            style="font-size: 15px; font-weight: bold; color: #e9e9e9;" (click)="stopPreviewChannel()">{{channel.name}}
          </ion-label>

          <ion-label *ngIf="!channel.iframe" [attr.id]="channel.id"
            style="font-size: 15px; font-weight: bold; color: #e9e9e9;"
            (click)="getPreviewChannel(channel.id)">{{channel.name}}

            <ion-label style="font-size: 12px; font-weight: 400; color: #fff;"
              *ngIf="channel.transmitiendo.current !== ''"><ion-icon name="chevron-forward-outline"
                style="color: #fff;"></ion-icon>{{channel.transmitiendo.current}}</ion-label>
            <ion-label style="font-size: 12px; font-weight: 400; color: #fff;"
              *ngIf="channel.transmitiendo.next !== ''">{{channel.transmitiendo.next}}</ion-label>

          </ion-label>

          <ion-icon *ngIf="channel.parrilla.length" name="calendar-outline"
            style="font-size: 22px; color: #fff; vertical-align: bottom;margin-right: 0px;margin-left: 5px;padding: 0px;"
            (click)="setOpen(true, channel)"></ion-icon>
          <ion-icon *ngIf="!channel.parrilla.length" name="calendar-outline"
            style="font-size: 22px; color: #000; vertical-align: bottom;margin-right: 0px;margin-left: 5px;padding: 0px;"></ion-icon>
          <ion-icon name="globe-outline"
            style="font-size: 22px;margin-left: 10px;margin-right: 0px;padding: 0px; vertical-align: bottom; color: #fff"
            *ngIf="channel.website !== ''" (click)="stopPreviewChannel() ; openWebSite(channel.website)"></ion-icon>
          <ion-icon name="globe-outline"
            style="font-size: 22px;margin-left: 10px;margin-right: 0px;padding: 0px; vertical-align: bottom; color: #000"
            *ngIf="channel.website === ''"></ion-icon>

        </ion-item>

        <ion-item color="dark" *ngIf="channel.enabled && channel.url.includes('http:')">

          <ion-icon [ngStyle]="{'color': channel.estado ? 'rgb(25, 212, 0)' : '#ff0230'}"
            [attr.name]="channel.estado ? 'checkmark-outline' : 'close-outline'"
            style="font-size: 21px; margin-right: 10px;"></ion-icon>

          <img class="channel-logo" [src]="channel.logo"><ion-label [attr.id]="channel.id"
            style="font-size: 15px; font-weight: bold; color: rgb(255, 234, 195);"
            (click)="stopPreviewChannel(); openChannelUrl(channel.url, channel.string)">{{channel.name}}

            <ion-label style="font-size: 12px; font-weight: 400;" *ngIf="channel.transmitiendo.current !== ''"><ion-icon
                name="chevron-forward-outline"
                style="color: #fff;"></ion-icon>{{channel.transmitiendo.current}}</ion-label>
            <ion-label style="font-size: 12px; font-weight: 400;"
              *ngIf="channel.transmitiendo.next !== ''">{{channel.transmitiendo.next}}</ion-label>

          </ion-label>

          <ion-icon *ngIf="channel.parrilla.length" name="calendar-outline"
            style="font-size: 22px; color: #fff; vertical-align: bottom;margin-right: 0px;margin-left: 5px;padding: 0px;"
            (click)="setOpen(true, channel)"></ion-icon>

          <ion-icon *ngIf="!channel.parrilla.length" name="calendar-outline"
            style="font-size: 22px; color: #000; vertical-align: bottom;margin-right: 0px;margin-left: 5px;padding: 0px;"></ion-icon>

          <ion-icon name="globe-outline"
            style="font-size: 22px;margin-left: 10px;margin-right: 0px;padding: 0px; vertical-align: bottom; color: #fff"
            *ngIf="channel.website !== ''" (click)="openWebSite(channel.website)"></ion-icon>

          <ion-icon name="globe-outline"
            style="font-size: 22px;margin-left: 10px;margin-right: 0px;padding: 0px; vertical-align: bottom; color: #000"
            *ngIf="channel.website === ''"></ion-icon>

        </ion-item>

      </ion-list>

      <!-- INICIO POPOVER -->
      <!-- VERSION LOG -->
      <ion-popover trigger="logtrigger" triggerAction="click">
        <ng-template>
          <ion-content class="ion-padding" [innerHTML]="logData.description" style="font-size: 14px;">

          </ion-content>
        </ng-template>
      </ion-popover>

    </ion-content>

  </div>

</ion-content>

<!-- INICIO MODALES -->

<!-- MODAL PROGRAMACION -->
<ion-modal [isOpen]="isModalOpen" (willDismiss)="setOpen(false)">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-title><img [src]="channelModal.logo"
            style="width: 30px; vertical-align: middle; margin-right: 10px;">Programacion
          {{channelModal.name}}</ion-title>
        <ion-buttons slot="end">
          <ion-button *ngIf="isMobile" (click)="setOpen(false,channel)">Cerrar</ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    <ion-content class="ion-padding">
      <h4 class="ion-text-center">{{channelModal.dia}} {{channelModal.numeroDia}} de {{channelModal.mes}} del
        {{channelModal.year}}</h4>

      <ion-list *ngFor="let p of modalParrilla">
        <ion-item color="medium" lines="none" *ngIf="p.horaNormal + ' '+p.programa === modalParrilla.current.current"
          (click)="emptyFunction()">
          <ion-grid (click)="emptyFunction()">
            <ion-row (click)="emptyFunction()">
              <ion-col (click)="emptyFunction()" [routerLink]="">{{p.horaNormal}}</ion-col>
              <ion-col>{{p.programa}}</ion-col>
            </ion-row>
          </ion-grid>
        </ion-item>

        <ion-item *ngIf="p.horaNormal + ' '+p.programa !== modalParrilla.current.current" (click)="emptyFunction()">
          <ion-grid (click)="emptyFunction()">
            <ion-row (click)="emptyFunction()">
              <ion-col (click)="emptyFunction()" [routerLink]="">{{p.horaNormal}}</ion-col>
              <ion-col>{{p.programa}}</ion-col>
            </ion-row>
          </ion-grid>
        </ion-item>

      </ion-list>
    </ion-content>
  </ng-template>
</ion-modal>

<!-- MODAL PARA COMPARTIR LA APP (QR, WSP, INSTA, FB, ETC) -->

<ion-modal [isOpen]="isModalShareAppOpen" (willDismiss)="openShareAppModal(false)">
  <ng-template>

    <ion-header>
      <ion-toolbar color="light">
        <ion-title class="ion-text-center">Comparte la App</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="openShareAppModal(false)">Cerrar</ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>

    <ion-content class="ion-padding" color="middle" class="ion-text-center">

      <ion-card color="dark">

        <ion-card-content>
          <h2>El codigo QR lleva directamente a Google play para que descarguen la app.</h2>
          <br>
          <ion-img src="../../assets/qrapp.png" style="width: 60%;margin: auto;"></ion-img>
          <br>
          <h2>O también puedes compartirla directamente en tus redes presionando en compartir.</h2>
          <br>
          <ion-text style="font-size: 21px;" color="success" (click)="openShareApp()"><ion-icon
              name="share-social-outline"
              style="font-size: 25px;margin-right: 10px; vertical-align: bottom;"></ion-icon>Compartir</ion-text>

          <br>
        </ion-card-content>
      </ion-card>


    </ion-content>
  </ng-template>
</ion-modal>
<!-- FIN MODALES -->